(this["webpackJsonptfjs-yolov5-example"]=this["webpackJsonptfjs-yolov5-example"]||[]).push([[0],{257:function(e,t,n){"use strict";n.r(t);var a=n(18),i=n(4),o=n(6),c=n(10),r=n(14),s=n(15),l=n(139),d=n.n(l),h=n(234),p=n.n(h),m=n(235),u=n.n(m),f=(n(264),n(76)),v=n(286),g="".concat("/tfjs-yolov5-example","/web_model/model.json"),j=["c","c1","castle","f","f1","g","g1","g2","m","m1","m2","m3","s","s1","s2","w","w1"],w=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(o.a)(this,n);for(var c=arguments.length,r=new Array(c),s=0;s<c;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={model:null,preview:"",predictions:[]},e.onDrop=function(t,n,a){e.setState({preview:t[0].preview||a[0]})},e.cropToCanvas=function(e,t,n){var a=e.naturalWidth,i=e.naturalHeight;n.clearRect(0,0,n.canvas.width,n.canvas.height),n.fillStyle="#000000",n.fillRect(0,0,t.width,t.height);var o=Math.min(t.width/e.naturalWidth,t.height/e.naturalHeight),c=Math.round(a*o),r=Math.round(i*o);n.drawImage(e,0,0,a,i,(t.width-c)/2,(t.height-r)/2,c,r)},e.onImageChange=function(t){var n=document.getElementById("canvas"),o=n.getContext("2d");e.cropToCanvas(t.target,n,o);var c=v.image.resizeBilinear(v.browser.fromPixels(n),[320,320]).div(255).expandDims(0),r=performance.now();e.state.model.executeAsync(c).then((function(e){var t=performance.now(),s=document.createElement("div");s.innerHTML="Inference took: ".concat(t-r," ms"),document.body.appendChild(s);var l="16px sans-serif";o.font=l,o.textBaseline="top";var d=e.map((function(e){return e.dataSync()})),h=Object(i.a)(d,4),p=h[0],m=h[1],u=h[2],f=Object(i.a)(h[3],1)[0];p=p.slice(0,4*f),m=m.slice(0,f),u=u.slice(0,f),c.dispose(),v.dispose(e);var g,w=v.tidy((function(){return v.image.nonMaxSuppression(v.tensor2d(p,[p.length/4,4]),m,49,.5,.5)})).dataSync(),b=Object(a.a)(w);try{for(b.s();!(g=b.n()).done;){var x=g.value,y=p.slice(4*x,4*(x+1)),O=Object(i.a)(y,4),F=O[0],D=O[1],S=O[2],C=O[3];F*=n.width,S*=n.width,D*=n.height,C*=n.height;var M=S-F,k=C-D,I=j[u[x]],z=m[x].toFixed(2);o.strokeStyle="#00FFFF",o.lineWidth=4,o.strokeRect(F,D,M,k),o.fillStyle="#00FFFF";var T=o.measureText(I+":"+z).width,B=parseInt(l,10);o.fillRect(F,D,T+4,B+4)}}catch(P){b.e(P)}finally{b.f()}var L,N=Object(a.a)(w);try{for(N.s();!(L=N.n()).done;){var R=L.value,E=p.slice(4*R,4*(R+1)),H=Object(i.a)(E,3),W=H[0],A=H[1];W*=n.width,A*=n.height;var J=j[u[R]],G=m[R].toFixed(2);o.fillStyle="#000000",o.fillText(J+":"+G,W,A)}}catch(P){N.e(P)}finally{N.f()}}))},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;v.loadGraphModel(g).then((function(t){console.log({model:t}),e.setState({model:t})}))}},{key:"render",value:function(){return Object(f.jsx)("div",{className:"Dropzone-page",children:this.state.model?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{children:[(this.state.model.artifacts.weightData.byteLength/1024/1024).toFixed(3)," ","Mb"]}),Object(f.jsxs)(u.a,{className:"Dropzone",accept:"image/jpeg, image/png, .jpg, .jpeg, .png",multiple:!1,onDrop:this.onDrop,children:[this.state.preview?Object(f.jsx)("img",{alt:"upload preview",onLoad:this.onImageChange,className:"Dropzone-img",src:this.state.preview}):"Choose or drop a file.",Object(f.jsx)("canvas",{id:"canvas",width:"640",height:"640"})]})]}):Object(f.jsx)("div",{className:"Dropzone",children:"Loading model..."})})}}]),n}(d.a.Component),b=document.getElementById("root");p.a.render(Object(f.jsx)(w,{}),b)},264:function(e,t,n){},271:function(e,t){},272:function(e,t){},280:function(e,t){},283:function(e,t){},284:function(e,t){},285:function(e,t){}},[[257,1,2]]]);
//# sourceMappingURL=main.9d1b10ff.chunk.js.map