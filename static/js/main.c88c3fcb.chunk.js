(this["webpackJsonptfjs-yolov5-example"]=this["webpackJsonptfjs-yolov5-example"]||[]).push([[0],{257:function(e,t,a){"use strict";a.r(t);var n=a(5),o=a(6),i=a(10),c=a(14),r=a(15),s=a(139),l=a.n(s),d=a(234),h=a.n(d),p=a(235),m=a.n(p),u=(a(264),a(76)),v=a(286),f="".concat("/tfjs-yolov5-example","/web_model/model.json"),g=["1","12","17","18","19","25","26","3","34","5","8","9","Q","a","an","b","c","d","e","er","f","g","h","he","i","in","j","k","l","m","n","o","p","q","qu","r","s","t","t-","th","u","v","w","wild","x","y","z"],j=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={model:null,preview:"",predictions:[]},e.onDrop=function(t,a,n){e.setState({preview:t[0].preview||n[0]})},e.cropToCanvas=function(e,t,a){var n=e.naturalWidth,o=e.naturalHeight;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="#000000",a.fillRect(0,0,t.width,t.height);var i=Math.min(t.width/e.naturalWidth,t.height/e.naturalHeight),c=Math.round(n*i),r=Math.round(o*i);a.drawImage(e,0,0,n,o,(t.width-c)/2,(t.height-r)/2,c,r)},e.onImageChange=function(t){var a=document.getElementById("canvas"),o=a.getContext("2d");e.cropToCanvas(t.target,a,o);var i=v.image.resizeBilinear(v.browser.fromPixels(a),[320,320]).div(255).expandDims(0),c=performance.now();e.state.model.executeAsync(i).then((function(e){var t=performance.now(),i=document.createElement("div");i.innerHTML="Inference took: ".concat(t-c," ms"),document.body.appendChild(i);var r="16px sans-serif";o.font=r,o.textBaseline="top";var s,l=Object(n.a)(e,4),d=l[0],h=l[1],p=l[2],m=l[3];for(console.log({boxes:d.dataSync(),scores:h.dataSync(),classes:p.dataSync(),valid_detections:m.dataSync()}),s=0;s<m.dataSync()[0];++s){var u=d.dataSync().slice(4*s,4*(s+1)),v=Object(n.a)(u,4),f=v[0],j=v[1],y=v[2],w=v[3];f*=a.width,y*=a.width,j*=a.height;var b=y-f,x=(w*=a.height)-j,S=g[p.dataSync()[s]],O=h.dataSync()[s].toFixed(2);o.strokeStyle="#00FFFF",o.lineWidth=4,o.strokeRect(f,j,b,x),o.fillStyle="#00FFFF";var F=o.measureText(S+":"+O).width,D=parseInt(r,10);o.fillRect(f,j,F+4,D+4)}for(s=0;s<m.dataSync()[0];++s){var k=d.dataSync().slice(4*s,4*(s+1)),C=Object(n.a)(k,3),I=C[0],M=C[1];I*=a.width,M*=a.height;var z=g[p.dataSync()[s]],T=h.dataSync()[s].toFixed(2);o.fillStyle="#000000",o.fillText(z+":"+T,I,M)}}))},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;v.loadGraphModel(f).then((function(t){console.log({model:t}),e.setState({model:t})}))}},{key:"render",value:function(){return Object(u.jsx)("div",{className:"Dropzone-page",children:this.state.model?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{children:[(this.state.model.artifacts.weightData.byteLength/1024/1024).toFixed(3)," ","Mb"]}),Object(u.jsxs)(m.a,{className:"Dropzone",accept:"image/jpeg, image/png, .jpg, .jpeg, .png",multiple:!1,onDrop:this.onDrop,children:[this.state.preview?Object(u.jsx)("img",{alt:"upload preview",onLoad:this.onImageChange,className:"Dropzone-img",src:this.state.preview}):"Choose or drop a file.",Object(u.jsx)("canvas",{id:"canvas",width:"640",height:"640"})]})]}):Object(u.jsx)("div",{className:"Dropzone",children:"Loading model..."})})}}]),a}(l.a.Component),y=document.getElementById("root");h.a.render(Object(u.jsx)(j,{}),y)},264:function(e,t,a){},271:function(e,t){},272:function(e,t){},280:function(e,t){},283:function(e,t){},284:function(e,t){},285:function(e,t){}},[[257,1,2]]]);
//# sourceMappingURL=main.c88c3fcb.chunk.js.map